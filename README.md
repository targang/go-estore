# Go Store - gRPC Backend

Go Store — это бекенд-приложение для онлайн-магазина, реализованное с использованием gRPC.
Оно предоставляет API для администраторов и пользователей для работы с продуктами и заказами.

> **Предупреждение**  
> Этот проект не готов к использованию в продакшн-среде и был создан в учебных целях.
> Он предназначен для демонстрации концепций и не оптимизирован для реального использования.

## API

### **AdminService** - микросервис для администрирования продуктов и заказов

Используется Bearer авторизация

- **Login**: Авторизация администратора, получение JWT токена.
- **ListOrders**: Получение списка заказов.
- **UpdateOrderStatus**: Обновление статуса заказа.
- **CreateProduct**: Создание нового продукта.
- **DeleteProduct**: Удаление продукта.

### **ProductService**
- **GetProduct**: Получение информации о продукте по ID.
- **ListProducts**: Получение списка продуктов с пагинацией.

### **OrderService**
- **CreateOrder**: Создание нового заказа.
- **GetOrder**: Получение информации о заказе по ID.

API доступно через gRPC. Подробнее с RPC и правилами валидации можно ознакомиться в [.proto-файлах](proto)

## Используемые технологии

- **gRPC**: Для эффективной и масштабируемой передачи данных между сервисами.
- **PostgreSQL**: Реляционная база данных для хранения данных о заказах и продуктах.
- **pgx v5**: Библиотека-драйвер для работы с PostgreSQL в Go.
- **JWT**: Используется для авторизации администраторов с помощью токенов.
- **Go**: Язык программирования для реализации бекенда.
- **Easyp**: Для компиляции proto-файлов


## Структура проекта

### `cmd/server/main.go`

Точка входа в приложение. Создает конфигурацию и вызывает `app.Run(...)`

### `config`

Конфигурация приложения.

### `db`

Настройка и миграции базы данных.

### `internal`

#### `app`

Запуск gRPC сервера.

#### `controller/grpc`

Обработка запросов от внешних источников. Цель этого слоя - прием запросов, валидация, передача в соответствующие use case и отправка ответа клиенту.

##### `controller/interceptor`

Здесь находятся gRPC-интерсепторы приложения. В текущей версии они используются для авторизации пользователей.

### `model`

Структуры данных, связанные с конкретными сущностями.

### `repository`

Слой для работы с базой данных

### `usecase`

Слой бизнес-логики приложения. Принимает данные из `controller`, перенаправляет их и обрабатывает результат.

## `proto`

`.proto`-файлы с описанием API приложения.

## Переменные среды

Для правильной работы проекта необходимо установить следующие переменные среды:

### PostgreSQL

- `POSTGRES_DB` - имя базы данных PostgreSQL
- `POSTGRES_USER` - имя пользователя базы данных
- `POSTGRES_PASSWORD` - Пароль пользователя базы данных
- `POSTGRES_HOST` - хост базы данных
- `POSTGRES_PORT` - порт базы данных

### gRPC

- `GRPC_PORT` - порт для gRPC сервера

### Admin

- `ADMIN_USERNAME` - логин администратора
- `ADMIN_PASSWORD_HASH` - Хеш пароля администратора `bcrypt`
- `ADMIN_JWT_SECRET` - секретный ключ для генерации JWT

## Установка и запуск

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/yourusername/go_store.git
    cd go_store
    ```

2. Сгенерируйте файлы gRPC и gRPC-Gateway:
    ```bash
    easyp generate
    ```

3. Установите зависимости:
    ```bash
    go mod tidy
    ```

4. Запустите приложение
